<div class="analytic-view view-page grid spacing-16">
  <div class="row">
    <div class="col">
      <!-- NAME: not editable -->
      <app-name-property
        [config]="{
          mode: config.mode === 'edit' ? 'view' : config.mode,
          object: config.object,
        }"></app-name-property>
      <app-subheading
        [config]="config"
        (onOpenHistory)="openHistory()"
        (onOpenNotes)="openNotes()"></app-subheading>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <!-- ATT&CK ID -->
      <app-attackid-property
        class="grow-to-row"
        (attackIdGenerated)="setNameFromAttackId()"
        [config]="{
          mode: config.mode,
          object: config.object,
          required: true,
        }">
      </app-attackid-property>
    </div>
    <div class="col">
      <!-- VERSION NUMBER -->
      <app-version-property
        class="grow-to-row"
        [config]="{
          mode: config.mode,
          object: config.object,
        }"></app-version-property>
    </div>
  </div>
  <div class="row">
    <!-- DOMAINS -->
    <div class="col">
      <app-list-property
        class="grow-to-row"
        [config]="{
          mode: config.mode,
          object: config.object,
          field: 'domains',
          editType: 'select',
        }"></app-list-property>
    </div>
    <div class="col">
      <!-- PLATFORM -->
      <app-string-property
        class="grow-to-row"
        [config]="{
          mode: config.mode,
          object: config.object,
          field: 'platform',
          editType: 'select',
          disabled: !analytic.domains.length,
        }"></app-string-property>
    </div>
  </div>
  @if (config.mode === 'view') {
    <!-- DETECTION STRATEGY -->
    <!-- cannot be edited/diffed from the analytic page -->
    <div class="row">
      <div class="col">
        <app-list-property
          class="grow-to-row"
          [config]="{
            mode: config.mode,
            object: config.object,
            field: 'relatedDetections',
            label: 'related detection strategy',
            objectProperty: 'name',
            showLink: true,
          }"></app-list-property>
      </div>
    </div>
  }
  <div class="row">
    <div class="col">
      <!-- DESCRIPTION -->
      <app-descriptive-property
        [config]="{
          mode: config.mode,
          object: config.object,
          field: 'description',
          firstParagraphOnly: false,
          referencesField: 'external_references',
          label: 'Description',
        }"></app-descriptive-property>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <!-- LOG SOURCE REFERENCES -->
      <app-log-source-reference-property
        class="grow-to-row"
        [config]="{
          mode: config.mode,
          object: config.object,
        }"></app-log-source-reference-property>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <!-- MUTABLE ELEMENTS -->
      <app-subtype-property
        class="grow-to-row"
        [config]="{
          mode: config.mode,
          object: config.object,
          field: 'mutableElements',
          label: 'mutable elements',
          subtypeFields: [
            {
              name: 'field',
              label: 'mutable field',
              required: true,
              key: true,
              editType: 'string',
            },
            {
              name: 'description',
              required: true,
              editType: 'description',
            },
          ],
          tooltip: 'a mutable element',
        }"></app-subtype-property>
    </div>
  </div>
</div>
